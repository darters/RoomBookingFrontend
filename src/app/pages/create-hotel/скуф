import {Component, OnInit} from '@angular/core';
import {FormBuilder, FormGroup, FormsModule, ReactiveFormsModule, Validators} from "@angular/forms";
import {NgForOf, NgIf} from "@angular/common";
import {trimValidator} from "../../validators/trimValidator";
import {GoogleMap} from "@angular/google-maps";

@Component({
  selector: 'app-create-hotel',
  standalone: true,
  imports: [
    FormsModule,
    ReactiveFormsModule,
    NgIf,
    NgForOf,
    GoogleMap
  ],
  templateUrl: './create-hotel.component.html',
  styleUrl: './create-hotel.component.scss'
})
export class CreateHotelComponent implements OnInit {
  createHotelForm!: FormGroup
  isValidFilesType: boolean = true
  files: File[] = []

  center: google.maps.LatLngLiteral = { lat: 50, lng: 10 };
  zoom = 3;
  options: google.maps.MapOptions = {
    fullscreenControl: false,
    mapTypeControl: false,
    streetViewControl: false,
    zoomControl: false,
    scaleControl: false,
    rotateControl: false,
    gestureHandling: 'auto' // or 'none' depending on your needs
  };

  constructor(private formBuilder: FormBuilder) {
  }

  onMapClick(event: any) {
    const lat = event.latLng.lat();
    const lng = event.latLng.lng();
    console.log(`Clicked location: Latitude: ${lat}, Longitude: ${lng}`);
    // здесь можно добавить логику для обработки выбранного места
  }

  ngOnInit(): void {
    this.createHotelForm = this.formBuilder.group({
      title: ['', [ trimValidator(), Validators.required, Validators.minLength(3), Validators.maxLength(35)]]
      }
    )
  }

  fileBrowseHandler(event: any): void {
    const inputFile = event.target.files;
    this.isValidFilesType = true
    if (inputFile) {
      for (const file of inputFile) {
        if(file.type === "image/jpeg" || file.type === "image/jpg") {
          this.files.push(file)
        } else {
          this.isValidFilesType = false
        }
      }
      // this.files = [...this.files, ...validFiles];
    }
  }
  removeFile(file: File): void {
    this.files = this.files.filter(f => f !== file);
  }

  submit(): void {
    console.log(this.createHotelForm.value);
  }

}
